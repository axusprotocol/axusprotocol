<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AXUS | Проверка токенов</title>
  <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    
    #wallet-connection {
      margin: 20px 0;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .connect-btn {
      background: #0088cc;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    
    .status {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
    }
    
    .connected {
      background: #e6f7e6;
      color: #2e7d32;
    }
    
    .disconnected {
      background: #ffebee;
      color: #c62828;
    }
    
    .error {
      background: #fff3e0;
      color: #e65100;
    }
  </style>
</head>
<body>

<div id="wallet-connection">
  <h2>Подключение кошелька</h2>
  <button id="connect-btn" class="connect-btn">Подключить кошелек</button>
  <div id="connection-status" class="status disconnected">Кошелек не подключен</div>
</div>

<script>
  // Инициализация TonConnect
  const connector = new TonConnect.TonConnect({
    manifestUrl: 'https://ton-connect.github.io/demo-dapp-with-react/tonconnect-manifest.json'
  });

  // Элементы интерфейса
  const connectBtn = document.getElementById('connect-btn');
  const statusDiv = document.getElementById('connection-status');

  // Проверка существующего подключения
  async function checkConnection() {
    try {
      const walletConnectionSource = {
        jsBridgeKey: 'tonconnect'
      };

      const connection = await connector.connect(walletConnectionSource);
      
      if (connection) {
        statusDiv.textContent = `Кошелек подключен: ${connection.device.appName}`;
        statusDiv.className = 'status connected';
        connectBtn.textContent = 'Отключить';
      } else {
        statusDiv.textContent = 'Кошелек не подключен';
        statusDiv.className = 'status disconnected';
        connectBtn.textContent = 'Подключить кошелек';
      }
    } catch (error) {
      console.error('Ошибка подключения:', error);
      statusDiv.textContent = 'Ошибка подключения: ' + error.message;
      statusDiv.className = 'status error';
    }
  }

  // Обработчик кнопки подключения
  connectBtn.addEventListener('click', async () => {
    if (connector.connected) {
      await connector.disconnect();
      statusDiv.textContent = 'Кошелек отключен';
      statusDiv.className = 'status disconnected';
      connectBtn.textContent = 'Подключить кошелек';
    } else {
      try {
        statusDiv.textContent = 'Откройте приложение кошелька...';
        statusDiv.className = 'status';
        
        const wallets = await connector.getWallets();
        await connector.connect(wallets[0]);
        
        statusDiv.textContent = `Кошелек подключен: ${wallets[0].name}`;
        statusDiv.className = 'status connected';
        connectBtn.textContent = 'Отключить';
      } catch (error) {
        console.error('Ошибка подключения:', error);
        statusDiv.textContent = 'Ошибка подключения: ' + error.message;
        statusDiv.className = 'status error';
      }
    }
  });

  // Проверяем подключение при загрузке
  window.addEventListener('load', checkConnection);
</script>

</body>
</html>
